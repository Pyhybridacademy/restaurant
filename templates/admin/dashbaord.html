{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Dashboard - {{ site_title|default:"Django site admin" }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Home</a> &rsaquo; Dashboard
</div>
{% endblock %}

{% block content %}
<div class="dashboard">
    <h1>Restaurant Dashboard</h1>
    
    <!-- Statistics Cards -->
    <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #28a745;">
            <h3 style="margin: 0; color: #28a745;">Total Orders</h3>
            <p style="font-size: 2em; margin: 10px 0; font-weight: bold;">{{ stats.total_orders }}</p>
        </div>
        
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #007bff;">
            <h3 style="margin: 0; color: #007bff;">Today's Orders</h3>
            <p style="font-size: 2em; margin: 10px 0; font-weight: bold;">{{ stats.today_orders }}</p>
        </div>
        
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107;">
            <h3 style="margin: 0; color: #ffc107;">Pending Orders</h3>
            <p style="font-size: 2em; margin: 10px 0; font-weight: bold;">{{ stats.pending_orders }}</p>
        </div>
        
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #28a745;">
            <h3 style="margin: 0; color: #28a745;">Total Revenue</h3>
            <p style="font-size: 2em; margin: 10px 0; font-weight: bold;">${{ stats.total_revenue }}</p>
        </div>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
        <!-- Pending Orders -->
        <div class="module">
            <h2>Orders Needing Attention</h2>
            <table style="width: 100%;">
                <thead>
                    <tr>
                        <th>Order #</th>
                        <th>Customer</th>
                        <th>Status</th>
                        <th>Total</th>
                        <th>Time</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in pending_orders %}
                    <tr>
                        <td><a href="{% url 'admin:order_order_change' order.id %}">#{{ order.order_number }}</a></td>
                        <td>{{ order.customer_name }}</td>
                        <td>
                            <span style="padding: 4px 8px; border-radius: 4px; font-size: 12px; 
                                {% if order.status == 'pending' %}background: #fff3cd; color: #856404;
                                {% elif order.status == 'paid' %}background: #d1ecf1; color: #0c5460;{% endif %}">
                                {{ order.get_status_display }}
                            </span>
                        </td>
                        <td>${{ order.total }}</td>
                        <td>{{ order.created_at|timesince }} ago</td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="5">No pending orders</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Popular Items -->
        <div class="module">
            <h2>Popular Menu Items</h2>
            <table style="width: 100%;">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Category</th>
                        <th>Orders</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in popular_items %}
                    <tr>
                        <td><a href="{% url 'admin:menu_food_change' item.id %}">{{ item.name }}</a></td>
                        <td>{{ item.category.name }}</td>
                        <td>{{ item.order_count }}</td>
                        <td>${{ item.price }}</td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="4">No data available</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Recent Orders -->
    <div class="module" style="margin-top: 30px;">
        <h2>Recent Orders</h2>
        <table style="width: 100%;">
            <thead>
                <tr>
                    <th>Order #</th>
                    <th>Customer</th>
                    <th>Status</th>
                    <th>Total</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for order in recent_orders %}
                <tr>
                    <td><a href="{% url 'admin:order_order_change' order.id %}">#{{ order.order_number }}</a></td>
                    <td>{{ order.customer_name }}</td>
                    <td>
                        <span style="padding: 4px 8px; border-radius: 4px; font-size: 12px;
                            {% if order.status == 'pending' %}background: #fff3cd; color: #856404;
                            {% elif order.status == 'paid' %}background: #d1ecf1; color: #0c5460;
                            {% elif order.status == 'confirmed' %}background: #d4edda; color: #155724;
                            {% elif order.status == 'preparing' %}background: #ffeaa7; color: #856404;
                            {% elif order.status == 'ready' %}background: #e2e3e5; color: #383d41;
                            {% elif order.status == 'delivered' %}background: #d4edda; color: #155724;
                            {% elif order.status == 'cancelled' %}background: #f8d7da; color: #721c24;{% endif %}">
                            {{ order.get_status_display }}
                        </span>
                    </td>
                    <td>${{ order.total }}</td>
                    <td>{{ order.created_at|date:"M d, Y H:i" }}</td>
                    <td>
                        <a href="{% url 'admin:order_order_change' order.id %}" style="margin-right: 10px;">Edit</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<style>
.dashboard h1 {
    color: #333;
    margin-bottom: 20px;
}

.dashboard table {
    border-collapse: collapse;
}

.dashboard table th,
.dashboard table td {
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.dashboard table th {
    background-color: #f8f9fa;
    font-weight: bold;
}

.dashboard .module {
    background: white;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 20px;
}

.dashboard .module h2 {
    margin-top: 0;
    color: #333;
    border-bottom: 1px solid #eee;
    padding-bottom: 10px;
}
</style>
{% endblock %}
